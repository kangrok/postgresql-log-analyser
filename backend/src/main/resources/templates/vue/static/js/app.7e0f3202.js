(function(){"use strict";var e={5975:function(e,t,a){var n=a(9242),r=a(3396);function l(e,t,a,n,l,s){const i=(0,r.up)("v-toolbar-title"),o=(0,r.up)("v-app-bar"),u=(0,r.up)("AnalysisPage"),d=(0,r.up)("UploadPage"),p=(0,r.up)("v-container"),c=(0,r.up)("v-app");return(0,r.wg)(),(0,r.j4)(c,null,{default:(0,r.w5)((()=>[(0,r.Wm)(o,{app:"",density:"comfortable",elevation:"0",color:"#3F51B5"},{default:(0,r.w5)((()=>[(0,r.Wm)(i,null,{default:(0,r.w5)((()=>[(0,r.Uk)("PostgreSQL logide analüsaator")])),_:1})])),_:1}),(0,r.Wm)(p,{class:"content pt-16"},{default:(0,r.w5)((()=>[e.showAnalysis?((0,r.wg)(),(0,r.j4)(u,{key:0,onUpload:t[0]||(t[0]=e=>this.showAnalysis=!1),"analysis-result":this.analysis},null,8,["analysis-result"])):((0,r.wg)(),(0,r.j4)(d,{key:1,onAnalysis:e.openAnalysis},null,8,["onAnalysis"]))])),_:1})])),_:1})}var s=a(7139);const i=e=>((0,r.dD)("data-v-241ace44"),e=e(),(0,r.Cn)(),e),o={class:"container"},u=i((()=>(0,r._)("h3",{class:"pb-4"}," Analüüsi ajavahemik ",-1)));function d(e,t,a,n,l,i){const d=(0,r.up)("v-card-title"),p=(0,r.up)("v-spacer"),c=(0,r.up)("v-alert"),m=(0,r.up)("v-file-input"),y=(0,r.up)("v-card-text"),v=(0,r.up)("v-radio"),g=(0,r.up)("v-text-field"),h=(0,r.up)("v-col"),f=(0,r.up)("v-radio-group"),w=(0,r.up)("v-btn"),b=(0,r.up)("v-card-actions"),k=(0,r.up)("v-card");return(0,r.wg)(),(0,r.iD)("div",o,[(0,r.Wm)(k,{class:"upload-container pa-6 rounded-0",border:""},{default:(0,r.w5)((()=>[(0,r.Wm)(d,null,{default:(0,r.w5)((()=>[(0,r.Uk)("Laadi üles logifailide kaust")])),_:1}),(0,r.Wm)(p),(0,r.Wm)(y,null,{default:(0,r.w5)((()=>[""!==l.errorMessage?((0,r.wg)(),(0,r.j4)(c,{key:0,class:"mb-6 rounded-0",color:"red",variant:"tonal"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,s.zw)(this.errorMessage),1)])),_:1})):(0,r.kq)("",!0),(0,r.Wm)(m,{clearable:"",label:"Vali fail...",variant:"solo-filled","prepend-icon":"mdi-folder-upload",onChange:i.upload},null,8,["onChange"])])),_:1}),(0,r.Wm)(y,null,{default:(0,r.w5)((()=>[u,(0,r.Wm)(f,{modelValue:l.periodSelection,"onUpdate:modelValue":t[2]||(t[2]=e=>l.periodSelection=e)},{default:(0,r.w5)((()=>[(0,r.Wm)(v,{label:"Kõik logid",value:"all"}),(0,r.Wm)(v,{label:"Viimane nädal",value:"week"}),(0,r.Wm)(v,{label:"Muu ajavahemik",value:"custom"}),(0,r.Wm)(h,{class:"pl-12",style:{"max-width":"360px"}},{default:(0,r.w5)((()=>[(0,r.Wm)(g,{type:"datetime-local",prefix:"Algus:",disabled:"custom"!==l.periodSelection,modelValue:l.selectedStartDate,"onUpdate:modelValue":t[0]||(t[0]=e=>l.selectedStartDate=e)},null,8,["disabled","modelValue"]),(0,r.Wm)(g,{type:"datetime-local",prefix:"Lõpp:",disabled:"custom"!==l.periodSelection,modelValue:l.selectedEndDate,"onUpdate:modelValue":t[1]||(t[1]=e=>l.selectedEndDate=e)},null,8,["disabled","modelValue"])])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,r.Wm)(b,null,{default:(0,r.w5)((()=>[(0,r.Wm)(p),(0,r.Wm)(w,{color:"#3F51B5",type:"submit",variant:"elevated",onClick:i.analyse},{default:(0,r.w5)((()=>[(0,r.Uk)(" Analüüsi ")])),_:1},8,["onClick"])])),_:1})])),_:1})])}var p=a(4161),c={data(){return{uploadedFile:void 0,periodSelection:"all",errorMessage:"",startDate:void 0,endDate:void 0,selectedStartDate:(new Date).toISOString().substring(0,16),selectedEndDate:(new Date).toISOString().substring(0,16),uploadFailed:!1}},methods:{upload(e){this.uploadedFile=e.target.files[0]},analyse(){if(!this.uploadedFile)return void(this.errorMessage="Vali zip-fail või logifail.");if(!this.validateDates())return void(this.errorMessage="Valitud alguskuupäev peab olema enne lõpukuupäeva.");const e=this.uploadedFile.name.endsWith(".zip")?"zip":"single";p.Z.post("/analysis/"+e,this.createRequestData(),{headers:{"Content-Type":"multipart/form-data"}}).then((e=>this.$emit("analysis",e.data)))},validateDates(){return"custom"===this.periodSelection?(this.startDate=new Date(this.selectedStartDate),this.endDate=new Date(this.selectedEndDate),this.startDate<=this.endDate):("week"===this.periodSelection&&(this.endDate=new Date,this.startDate=new Date(this.endDate.getTime()-6048e5)),!0)},createRequestData(){const e=new FormData;return e.append("logs",this.uploadedFile),"all"!==this.periodSelection&&(e.append("start",this.startDate.toISOString()),e.append("end",this.endDate.toISOString())),e}}},m=a(89);const y=(0,m.Z)(c,[["render",d],["__scopeId","data-v-241ace44"]]);var v=y;const g={class:"result-container"};function h(e,t,a,n,l,s){const i=(0,r.up)("v-btn"),o=(0,r.up)("v-list-item"),u=(0,r.up)("v-divider"),d=(0,r.up)("v-navigation-drawer"),p=(0,r.up)("AnalysisSummary");return(0,r.wg)(),(0,r.iD)("div",g,[null!==a.analysisResult?((0,r.wg)(),(0,r.j4)(d,{key:0},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{class:"ma-6",onClick:t[0]||(t[0]=e=>this.$emit("upload")),color:"#3F51B5"},{default:(0,r.w5)((()=>[(0,r.Uk)("Laadi üles uus kaust")])),_:1}),(0,r.Wm)(o,{link:"",title:"Rühma kokkuvõte",onClick:t[1]||(t[1]=e=>this.displayData=a.analysisResult.summary),class:"py-3"}),(0,r.Wm)(u),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(a.analysisResult.analysis,((e,t)=>((0,r.wg)(),(0,r.j4)(o,{link:"",title:e.studentName,onClick:t=>this.displayData=e,key:t,class:"py-3"},null,8,["title","onClick"])))),128))])),_:1})):(0,r.kq)("",!0),(0,r.Wm)(p,{analysis:this.displayData??a.analysisResult.summary},null,8,["analysis"])])}const f=e=>((0,r.dD)("data-v-bc79c3ce"),e=e(),(0,r.Cn)(),e),w=f((()=>(0,r._)("h1",null,"Logide analüüs",-1))),b={key:0,class:"pb-2"},k={key:1,class:"pb-6"},C={key:2},D=f((()=>(0,r._)("thead",null,null,-1))),_=f((()=>(0,r._)("td",null,"Päringute koguarv:",-1))),N=f((()=>(0,r._)("td",null,"Edukate päringute arv:",-1))),E={class:"valid-text-color"},W=f((()=>(0,r._)("td",null,"Vigaste päringute arv:",-1))),x={class:"error-text-color"},S={key:0},j=f((()=>(0,r._)("td",null,"Keskmine vigade arv tudengi kohta:",-1))),O={key:1},V=f((()=>(0,r._)("td",null,"Ühekordsete vigade arv:",-1))),A=f((()=>(0,r._)("h3",{class:"pb-6"},"Veatüüpide jaotus",-1))),z=f((()=>(0,r._)("th",null,"Veateade",-1))),F={key:0},P={key:1},q={key:0},U={key:1},$={key:3,class:"pa-8"},M={key:1,class:"text-center"};function R(e,t,a,n,l,i){const o=(0,r.up)("v-col"),u=(0,r.up)("v-row"),d=(0,r.up)("v-divider"),p=(0,r.up)("v-table"),c=(0,r.up)("v-progress-circular"),m=(0,r.up)("Bar"),y=(0,r.up)("v-container"),v=(0,r.up)("v-expansion-panel-text"),g=(0,r.up)("v-expansion-panel"),h=(0,r.up)("v-expansion-panels"),f=(0,r.up)("v-card");return a.analysis.hasOwnProperty("errorCount")?((0,r.wg)(),(0,r.j4)(y,{key:0},{default:(0,r.w5)((()=>[(0,r.Wm)(y,{class:"pt-8"},{default:(0,r.w5)((()=>[w,a.analysis.hasOwnProperty("studentName")&&null!=a.analysis.studentName?((0,r.wg)(),(0,r.iD)("h2",b,(0,s.zw)(a.analysis.studentName),1)):a.analysis.hasOwnProperty("studentName")?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("h2",k,"Rühma kokkuvõte")),(0,r.Wm)(f,{class:"pt-8 rounded-0"},{default:(0,r.w5)((()=>[null!=a.analysis.studentName?((0,r.wg)(),(0,r.j4)(u,{key:0,class:"pb-6 px-16"},{default:(0,r.w5)((()=>[(0,r.Wm)(o,null,{default:(0,r.w5)((()=>[(0,r.Uk)(" Analüüsitud failid: ")])),_:1}),(0,r.Wm)(o,null,{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(a.analysis.fileNames,(e=>((0,r.wg)(),(0,r.iD)("p",{key:e},(0,s.zw)(e),1)))),128))])),_:1})])),_:1})):(0,r.kq)("",!0),null!=a.analysis.studentName?((0,r.wg)(),(0,r.j4)(d,{key:1})):(0,r.kq)("",!0),a.analysis.validCount+a.analysis.errorCount>0?((0,r.wg)(),(0,r.iD)("div",C,[(0,r.Wm)(u,{class:"px-16 py-8"},{default:(0,r.w5)((()=>[(0,r.Wm)(p,null,{default:(0,r.w5)((()=>[D,(0,r._)("tbody",null,[(0,r._)("tr",null,[_,(0,r._)("td",null,(0,s.zw)(this.$props.analysis.errorCount+this.$props.analysis.validCount),1)]),(0,r._)("tr",null,[N,(0,r._)("td",E,(0,s.zw)(this.$props.analysis.validCount)+" ("+(0,s.zw)((100*a.analysis.validCount/(a.analysis.errorCount+a.analysis.validCount)).toFixed(1))+"%) ",1)]),(0,r._)("tr",null,[W,(0,r._)("td",x,(0,s.zw)(this.$props.analysis.errorCount)+" ("+(0,s.zw)((100*a.analysis.errorCount/(a.analysis.errorCount+a.analysis.validCount)).toFixed(1))+"%) ",1)]),null===this.$props.analysis.studentName?((0,r.wg)(),(0,r.iD)("tr",S,[j,(0,r._)("td",null,(0,s.zw)(this.$props.analysis.errorCount/4),1)])):((0,r.wg)(),(0,r.iD)("tr",O,[V,(0,r._)("td",null,(0,s.zw)(this.$props.analysis.uniqueErrorCount),1)]))])])),_:1}),a.analysis.errorCount>0||a.analysis.validCount>0?((0,r.wg)(),(0,r.j4)(c,{key:0,class:"ml-16 mt-12",size:160,width:30,"model-value":100*a.analysis.errorCount/(a.analysis.errorCount+a.analysis.validCount),color:"red-lighten-1","bg-color":"light-green-lighten-1"},null,8,["model-value"])):(0,r.kq)("",!0)])),_:1}),(0,r.Wm)(y,{class:"pa-8"},{default:(0,r.w5)((()=>[A,(0,r.Wm)(m,{data:i.chartData,options:l.chartOptions},null,8,["data","options"])])),_:1}),Object.keys(a.analysis.repeatedErrors).length>0?((0,r.wg)(),(0,r.j4)(h,{key:0},{default:(0,r.w5)((()=>[(0,r.Wm)(g,{title:"Korduvad vead"},{default:(0,r.w5)((()=>[(0,r.Wm)(v,null,{default:(0,r.w5)((()=>[(0,r.Wm)(p,null,{default:(0,r.w5)((()=>[(0,r._)("thead",null,[(0,r._)("tr",null,[z,null!=a.analysis.studentName?((0,r.wg)(),(0,r.iD)("th",F,"Korduste arv")):((0,r.wg)(),(0,r.iD)("th",P,"Kogus"))])]),(0,r._)("tbody",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(Object.entries(a.analysis.repeatedErrors),(([e,t])=>((0,r.wg)(),(0,r.iD)("tr",{key:e},[e.hasOwnProperty("message")?((0,r.wg)(),(0,r.iD)("td",q,(0,s.zw)(e.message),1)):((0,r.wg)(),(0,r.iD)("td",U,(0,s.zw)(e),1)),(0,r._)("td",null,(0,s.zw)(t),1)])))),128))])])),_:1})])),_:1})])),_:1})])),_:1})):(0,r.kq)("",!0)])):((0,r.wg)(),(0,r.iD)("p",$,"Valitud ajavahemikus ei tehtud ühtegi päringut."))])),_:1})])),_:1})])),_:1})):((0,r.wg)(),(0,r.iD)("div",M,[(0,r.Wm)(c,{indeterminate:"",color:"primary"})]))}var K=a(5866),B=a(9646);B.kL.register(B.Dx,B.u,B.De,B.ZL,B.uw,B.f$);var T={name:"AnalysisSummary",components:{Bar:K.$Q},props:{analysis:{studentName:String,fileNames:Array,errorCount:Number,uniqueErrorCount:Number,validCount:Number,syntaxErrorCount:Number,nonExistentValueCount:Number,constraintViolationCount:Number,alreadyExistsErrorCount:Number,aggregateErrorCount:Number,typoCount:Number,otherErrorCount:Number,repeatedErrors:Object}},data(){return{chartOptions:{plugins:{legend:{display:!1}},scales:{y:{min:0,ticks:{stepSize:1}}}}}},computed:{chartData(){return console.log(Object.keys(this.analysis.repeatedErrors).length),{labels:["Süntaksivead",["Defineerimata","väärtuse","kasutamine"],["Kitsenduse","rikkumine"],"Trükivead",["Agregeeritud","funktsiooni","vead"],["Topelt","defineerimine"],"Muud vead"],datasets:[{title:"Veatüüpide jaotus",backgroundColor:["#5EBD9B","#F8DA62","#104D83","#F79F3D","#72CAD8","#E34F5B","#A048A4"],data:[this.analysis.syntaxErrorCount,this.analysis.nonExistentValueCount,this.analysis.constraintViolationCount,this.analysis.typoCount,this.analysis.aggregateErrorCount,this.analysis.alreadyExistsErrorCount,this.analysis.otherErrorCount]}]}}}};const I=(0,m.Z)(T,[["render",R],["__scopeId","data-v-bc79c3ce"]]);var L=I,Z={components:{AnalysisSummary:L},props:{analysisResult:{summary:{errorCount:Number,uniqueErrorCount:Number,validCount:Number,syntaxErrorCount:Number,nonExistentValueCount:Number,constraintViolationCount:Number,alreadyExistsErrorCount:Number,typoCount:Number,aggregateErrorCount:Number,otherErrors:Number,repeatedErrors:Object},analysis:[{studentName:String,fileNames:Array,errorCount:Number,uniqueErrorCount:Number,validCount:Number,syntaxErrorCount:Number,nonExistentValueCount:Number,constraintViolationCount:Number,alreadyExistsErrorCount:Number,typoCount:Number,aggregateErrorCount:Number,otherErrors:Number,repeatedErrors:Object}]}},data(){return{displayData:void 0}}};const H=(0,m.Z)(Z,[["render",h],["__scopeId","data-v-4761ba17"]]);var Y=H,Q=(0,r.aZ)({components:{AnalysisPage:Y,UploadPage:v},data(){return{showAnalysis:!1,analysis:void 0}},methods:{openAnalysis(e){this.analysis=e,console.log(this.analysis),this.showAnalysis=!0}}});const G=(0,m.Z)(Q,[["render",l]]);var J=G,X=(a(8026),a(8727)),ee=a(9474),te=a(8600);const ae=(0,X.Rd)({components:ee,directives:te});(0,n.ri)(J).use(ae).mount("#app")}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var l=t[n]={exports:{}};return e[n].call(l.exports,l,l.exports,a),l.exports}a.m=e,function(){var e=[];a.O=function(t,n,r,l){if(!n){var s=1/0;for(d=0;d<e.length;d++){n=e[d][0],r=e[d][1],l=e[d][2];for(var i=!0,o=0;o<n.length;o++)(!1&l||s>=l)&&Object.keys(a.O).every((function(e){return a.O[e](n[o])}))?n.splice(o--,1):(i=!1,l<s&&(s=l));if(i){e.splice(d--,1);var u=r();void 0!==u&&(t=u)}}return t}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[n,r,l]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,l,s=n[0],i=n[1],o=n[2],u=0;if(s.some((function(t){return 0!==e[t]}))){for(r in i)a.o(i,r)&&(a.m[r]=i[r]);if(o)var d=o(a)}for(t&&t(n);u<s.length;u++)l=s[u],a.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return a.O(d)},n=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(5975)}));n=a.O(n)})();
//# sourceMappingURL=app.7e0f3202.js.map